<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="{{ url_for('polls.static', filename='results.css') }}">
        <title>results</title>  
    </head>

    <body>
        <header id="loggedIn" class="header">
            <img style="cursor: pointer;" onclick="window.location.href='/'" id="logo" src="{{ url_for('static', filename='assets/logo.png') }}" >
    
            <nav class="navbar">
                <a href="/">Home</a>
                <a href="{{ url_for('home.about') }}">About</a>
                <a href="{{ url_for('home.contact') }}">Contact</a>
                <a href="{{ url_for('polls.mypolls') }}">My Polls</a>
                <a href="{{ url_for('polls.createpoll') }}">Create</a>
                <a href="{{ url_for('auth.logout') }}" class="start">Log Out</a>
            </nav>
        </header>

        <div class="wrapper">
            <div class="tab">
                <a class="tablinks active" onclick="openPoll(event, 'Pie')">Pie</a>
                <a class="tablinks" onclick="openPoll(event, 'Polls')">Polls</a>
                <a class="tablinks" onclick="openPoll(event, 'Votes')">Votes</a>
            </div>

            <div id="PieChart" class="tabcharts" style="display: flex;"></div>

            <div style="display: none;" id="PollsChart" class="tabcharts">
                {% for result in results %}    
                    <div class="poll">
                        <div class="bar" style="height: {{result.candidate_results}}%"></div>
                        <p>{{ result.candidate_name }}</p>
                    </div>
                {% endfor %}
            </div>

            <div style="display: none;" class="tabcharts" id="VotesChart">
                <h3>Results:</h3>
                {% for result in results%}
                    <p>{{result.candidate_name}} : {{result.candidate_results}}%</p>
                {% endfor %}
            </div>
        </div>
        <div class="menu">
            <button>Add Voter</button>
            <button>Remove Voter</button>
            <button>Change Date</button>
            <button>Delete Survey</button>
        </div>

    </body>
    <script src="{{ url_for('polls.static', filename='results.js') }}"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['corechart']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {

            var data = google.visualization.arrayToDataTable([
            ['Task', 'Hours per Day'],
            {% for key in results.keys()%}
                    ['{{key}}',{{results[key]}}],
                {% endfor %}
            ]);

            var options = {
                backgroundColor: 'transparent' ,

                title: 'Results'
            };
            
            var chart = new google.visualization.PieChart(document.getElementById('PieChart'));
            chart.draw(data, options);
        }
    </script>
</html>